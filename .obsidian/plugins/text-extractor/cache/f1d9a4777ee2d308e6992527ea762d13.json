{"path":"_aula_virtual/SJK002/SJK002-U7-ImageSegmentation.pdf","text":"SJK002 Computer VisionMaster in Intelligent Systems2U7. Image SegmentationIndexIntroductionImagethresholdingRegiongrowingRegionsplittingSplit and mergeClusteringWatershedtransformOthersegmentationmethodsConnectedcomponentslabeling3U7. Image SegmentationSegmentationSegmentation:Divide animageintoregions.Region:Set ofconnectedpixelsthathavea series ofcommonfeatures.Features:•Gray level•Color•Other(e.g. texture, motion, depth, ...)“Segmentationofnontrivialimagesisoneofthemostdifficulttasksin imageprocessing. Segmentationaccuracydetermines thesuccessorfailureofcomputerizedanalysisprocedures”.(González & Woods, Digital ImageProcessing)4U7. Image SegmentationGray levelsObjectdetectionand recognition:•Separateobjectsfrombackgroundusinggray levelfeatures.•Objectrecognition, e.g., fromtheirshape.5U7. Image SegmentationColorObjectdetectionand recognition:•Regionrecognitionbytheircolor.•Objectscan be madebyserveralregions.6U7. Image SegmentationTextureObjectdetectionand recognition:•Non-uniformgray levelregions.•Needmore complexfeatures.7U7. Image SegmentationThresholdingTransforma gray levelimageintoa binaryimage.Weasume uniformgray levelobjectsand background.Clear objectsona dardbackgroundDarkobjectsona clearbackgroundObjectswithina gray levelinterval\u0000\u0000,\u0000\u0000\u00001\u0000\u0000,\u0000\u0000\u00000\u0000\u0000ℎ\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000,\u0000\u0000\u00001\u0000\u0000,\u0000\u0000\u00000\u0000\u0000ℎ\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000,\u0000\u0000\u00001\u0000\u0000\u0000\u0000\u0000,\u0000\u0000\u0000\u00000\u0000\u0000ℎ\u0000\u0000\u0000\u0000\u0000\u00008U7. Image SegmentationThresholdingDifferentmeansand standard deviationsforobjectsand backgroundHowtochoosea threshold?9U7. Image SegmentationAutomaticthresholdingOtsu’smethod:•AssumetwoGaussian distributions•Minimizetheweightedsum ofvariances10Otsu’smethodU7. Image SegmentationThresholdtthatminimizestheintra-classvariances(sum ofvariancesofeachcass) withprobabililtiesw0and w1Equivalenttomaximizinginter-classvariance11U7. Image SegmentationAutomaticthresholdingKittler-Illingworth’smethod.•AssumetwoGaussian distributions.•Mimimizeerror approximtingthehistogrambythesum oftheGaussians.12U7. Image SegmentationRecursive thresholdingWhenthereare severalobjects/backgrounds•Applya giventhresholdingmethod.•Analyzetheobtainedhistogram.•Repeattheprocessuntilthehistrogramper regiones approximatelyuniformFirststepRepeatRepeat13U7. Image SegmentationRegiongrowingOriginal imageResult(mean gray levelofregion)Result(Pseudocolor)Choosea set ofseedpointsforeachregionand makethemiterativelygrowingfromneighborpixelsuntilreachinganotherregionornotfulfillingtheregionhomogeneitycriterion.14RegionsplittingThe opposite approach to region growing.Top-down approach.Startfrom the entire image.If it is not homogeneous, splitinto four sub images.Repeatthe splitting step recursively until image is spliltinto homogeneous regions.U7. Image SegmentationR0R1R2R3R0R1R00R01R02R03Quadtree15Split and mergeStart with the whole image.If the variance is too high, split:•Break into quadrants.Mergeany adjacent regions that are similar enough.Repeat split and merge steps iteratively until no more splitting or merging occur.Problems: •Ifnotenoughiterationsregión contoursare notveryprecise.U7. Image Segmentation16U7. Image SegmentationSplit and mergeOriginal imageSplit & merge17U7. Image SegmentationClusteringClustering:•processtoorganizea set ofsamplesintogroupswhosesampleshavecertainsimilarityproperties(segmentation?).Cluster:•Set ofsimilar samplesamongthem(región?)Standard patternrecognitiontechnique.Segmentation:Eachimagepixel isconsidereda pointin anN-dimensional space.•Color images: onedimensionper color plane.•Textures: Onedimensión per eachtexturecharacertizationrepresentation.18U7. Image SegmentationClusteringK-means1.RandomlychooseK clustercenters.2.Calculatetheprobabilitythata samplebelongstoa cluster(distancetotheclustercenter).3.Assigneachsampletothemostprobable cluster(mínimum distancetoclustercenter).4.Recalculateclusterscenters.5.Repeatfromstep 2 untilno changesin samplesclusterassigmentormaximumofiterations.19K-meansclusteringU7. Image Segmentation20U7. Image SegmentationClusteringOriginal RGB imageIteration1Iteration3Iteration10Final result21U7. Image SegmentationWatershedtransformWatershed: ingeography, an area of high ground from which water flows down to a river. Mountain chain that separates two riverbeds.Imagegray levelscan be treatedas a topologicalsurface.22WatershedtransformU7. Image Segmentation23U7. Image SegmentationWatershedtransformUsuallyappliedtotheimagegradient:•Objects: flat areas, riverbeds.•Objectborders: gradientridges.Problem:in general, over-segmentation.24WatershedtransformU7. Image Segmentation25OthersegmentationmethodsMore complexsegmentationmethods:•Snakes•Level Sets•Graph Cuts•Generalized PCA•Deep Learning: Convolutional Neural Networks.•…U7. Image Segmentation26Active contours: SnakesU7. Image Segmentation27GraphcutsU7. Image SegmentationRepresentimageas a graphPixelsare nodesand edgeshaveweights(strenghts) torepresentneigbhorpixel similarity28GraphcutsU7. Image SegmentationCutweakedges29GraphcutsU7. Image Segmentation30ConvolutionalNeural Networks (CNNs)U7. Image Segmentation31U7. Image SegmentationConnectedcomponentslabelingAssigna label(numericalvalue) toallpixelsbelongingtothesameregion, i.e., toallpixelsconnectedamongthem.Connectivity: 4 or8.Algorithms:•Recursive.•Iterative.•Classical.\u0000Basedonanequivalencetable.\u0000Twoimagescans.32U7. Image SegmentationConnectivity4-connectivity8-connectivityDependingontheconnectivitytype, wewillobtain1 or4 regions33U7. Image SegmentationConnectedcomponentslabelingInitialmage(binary)Imagewithlabeledconnectedcomponents34U7. Image SegmentationConnectedcomponentslabeling1.Scantheimagefromtop-downand left-rigth.Ifpixel isobjectthen:a)Ititsup orleftneighborhas a label(onlyeitherofthem), assignthatlabel(4-connectivity)b)Ifbothpixelshavea label:a)Ifitisthesame, assignthatlabel.b)Iftheyare different, assignthesmallestone, and note in thetabletheselabelsare equivalents.c)Ifnoneofthemhas a label, assigna new label.2.Scantheimageagain, changepixel labelsbytheirsmallestequivalentlabels.35ConnectedcomponentslabelingU7. Image SegmentationFirstscan36ConnectedcomponentslabelingU7. Image SegmentationSecondscan37U7. Image SegmentationConnectedcomponentslabeling","libVersion":"0.3.2","langs":""}