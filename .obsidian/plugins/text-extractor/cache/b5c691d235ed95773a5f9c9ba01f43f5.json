{"path":"_aula_virtual/SJK002/SJK002-U10b MotionEstimationOpticFlow.pdf","text":"U10. MotionEstimationSJK002 ComputerVisionMaster in IntelligentSystems2U10. Motion EstimationIndexApplication examples.Optical flow.Global motion: image registration.•Gray level-based registration.•Criterion functions.•Optimization methods.3U10. Motion EstimationVideo mosaicing4U10. Motion EstimationVideo compression5U10. Motion EstimationImageregistrationOverlapping with reference image (maps).Medical image registration6U10. Motion EstimationStructurefrommotion7U10. Motion EstimationMotionsegmentationand tracking8U10. Motion EstimationIndexApplication examples.Optical flow.Global motion: image registration.•Gray level-based registration.•Criterion functions.•Optimization methods.9U10. Motion EstimationFrom3D to3D motion3D motionProjected (apparent) 2D motion10U10. Motion EstimationOpticalflowOptical Flow or velocity fieldYosemite sequenceMotion estimation of every pixel (dense motion field)11U10. Motion EstimationOptical flow estimationAssumptions:•Brightness (grey level) constancy assumption.•Small (u,v)pixel motion.12U10. Motion EstimationOptical flow equationAt the limit, (u,v) 013U10. Motion EstimationOptical flow equationOneequation and twounknowns (u,v)Meaning:•We can only estimate the optical flow componentin the gradient direction.•The so-called ”aperture problem”.Additional constraints are needed.14U10. Motion EstimationTheapertureproblem15U10. Motion EstimationOptical flow estimationAvoid the aperture problem.Additional constraints:•Optical flow is locally smoothAssume pixels in a window have the same (u,v)Example: window 5x5= 25 pixels16U10. Motion EstimationLukas-KanadealgorithmSolution: least squaresTwo unknowns d=(u,v)Sum up for all pixels in the windowMust be invertible.Not very small eigen values.One eigen value larger than the other one17U10. Motion EstimationEdge pixels–large gradients along borders.–1large, 2 small.18U10. Motion EstimationLow textured regions–small gradient magnitude.–1small, 2small19U10. Motion EstimationHigh textured regions–different gradients, large magnitudes.–1, large, 2 large20U10. Motion EstimationIterative Lucas-KanadealgorithmVelocity estimation of each pixel using the Lucas-Kanade algorithm.Transform H into Iusing the estimated optical flow:•Calculate resulting images using interpolation techniques.Repeat until convergence.21U10. Motion Estimationimage Iimage HGaussian pyramid of image HGaussian pyramid of image Iimage Iimage Hu=10 pixelsu=5 pixelsu=2.5 pixelsu=1.25 pixelsMultiresolution estimation22U10. Motion EstimationMultiresolution estimationL-K iterativeL-K iterativeTransform and over-sample...image Iimage HGaussian pyramid of image HGaussian pyramid of image Iimage Iimage H23U10. Motion EstimationExampleWithout multiresolutionWith multiresolution24U10. Motion EstimationIndexApplication examples.Optical flow.Global motion: image registration.•Gray level-based registration.•Criterion functions.•Optimization methods.25U10. Motion EstimationImageregistrationMultiview analysis: Mosaicking, Satellite images, ...Temporal analysis: Video segmentation, tracking, ...Multimodal analysis: Different sensors (CT-MR, ...)Scene-to-model: GIS, Medical imaging, ...“Find the correspondence between pixels in two images”“Find a unique geometric transformation that better fits motion of all pixels between two images26U10. Motion EstimationTechniquesFeature-based methods:•Uses feature or interest points:Reduced information.•Computationally efficient.“Grey level” based methods:•Uses raw image information:Overdetermined data.•Better accuracy.•Optimization methods:Criterion function.27U10. Motion EstimationFrom3D to2D motionMotion projection of 3D point in a 2D image plane.xyZXYPP’p’pI(x,y)28U10. Motion Estimation2D motionmodelsAffinemodel:•Corresponds to an a la orthographic projectionof a 3D plane motion:Perspective transformation:•Corresponds to a perspective projectionof a 3D plane motion.x’= a1 x + a2 y + a3;y’= a4 x + a5 y + a6;(x’,y’)=T(x,y)a1 x + a2 y + a3x’=a7 x + a8 y + 1a4 x + a5 y + a6y’=a7 x + a8 y + 1(x’,y’)=T(x,y)29U10. Motion Estimation2D motionmodels30U10. Motion EstimationCriterionfunctionDefine a criterion function:Estimate parameterswhich optimizethe criterion function:•Choose a strategy or minimization method.•Example: minimization using least squares:31U10. Motion EstimationGrey level-basedregistrationBrightness constancy assumption (BCA)Linearization: Optical flow equation32U10. Motion EstimationCriterionfunctionLinearization: Optical flow equation•Affine motion model•Optical flow:33U10. Motion EstimationOptimizationmethodsOrdinary Least Squares (OLS):•For lineal functions. Closed-form solution.•Sensitiveto “outliers”.Jacobian of the criterion function.Matrix (r x p) (observations x parameters)Independent term of the criterion function.Vector (r x 1)Parameters vector to be estimated. Vector (p x 1)34U10. Motion EstimationOptimizationmethodsOrdinary Least Squares (OLS):•Non linearfunctions:Newton-Gauss iterative method.Until increment is small or zero35U10. Motion EstimationOptimizationmethodsNewton-Gauss iterative algorithm: •Initialize•Repeat•Until is sufficiently small.36U10. Motion EstimationOptimizationmethodsRobust: estimators:•Bounded“outliers” influence.•M-estimators: Converted into iterative weighted LS estimators.Generalized Least Squares (GLS):•Use orthogonal (”geometric”) distances.•Non linear functions.•Residual minimization of observations.•Can estimate parameters and modify observationvalues.37U10. Motion EstimationExamples38ExamplesU10. Motion Estimation39ExamplesU10. Motion Estimation40U10. Motion EstimationExamplesGLS (BCA) OLS (OF) RLS (BCA)GLS (BCA) OLS (OF) RLS (BCA)41U10. Motion EstimationReferencesOptical flow:•D. J. Fleet. “Measuring the image velocity”. Kluwer Academic Publishers. 1992.•J.K. Aggarwal, N. Nandhakumar. “On the computation of motion from sequences of images –a review”. Proceeding of the IEEE 76:8, 917-935. 1988.•B.K.P. Horn, B. Schunck. “Determining optical flow”. Artificial Intelligence 17, 185-204.1981.Segmentation and tracking:•Badenas, J.; Sanchiz, J.M. and Pla, F., “Motion-Based Segmentation and Region-Tracking in Image Sequences”, Pattern Recognition, 2001, No. 34, pp. 661-670.42U10. Motion EstimationReferencesImage registration:•J.R. Bergen, P.J. Burt, R.Hingorani, and S. Peleg, “Athree-frame algorithm for estimating two-component image motion,” IEEE Transaction on Pattern Analysis and Machine Intelligence, vol. 14, no. 9, pp. 886–896, 1992.•J.M. Odobez and P. Bouthemy, “Robust multiresolution estimation of parametric motion models,” Int. J. Visual Communication and Image Representation, vol. 6, no. 4, pp. 348–365, 1995.•Montoliu, R. and Pla, F. “Multiple Parametric Motion Model Estimation and Segmentation”, International Conference on Image Processing, ICIP, Thessaloniki, Greece, 2001, ISBN 0-7803-6725-1, Vol. II, pp. 933-936.•Z. Zhang, “Parameter-estimation techniques: A tutorial with application to conic fitting,” Image and Vision Computing, Vol 15, no 1, pp. 59–76, 1997.","libVersion":"0.3.2","langs":""}