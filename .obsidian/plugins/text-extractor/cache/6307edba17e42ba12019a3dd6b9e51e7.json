{"path":"_aula_virtual/SJK002/SJK002-U5-EdgeDetection.pdf","text":"SJK002 Computer VisionMaster in Intelligent Sytems2U5. Border DetectionIndexIntroduction•Whatisanedge?•Stepsin edgedetectionEdgedetectorsbasedonimagegradient•Whatisimagegradient?•DetectorsEdgedetectorsbasedonLaplacianoperator•WhatistheLaplacian?•Detectors3U5. Border DetectionIntroduction: Whatisanedge?Edge= significantchangein imageintensityUsefulness: •Objectfeatures•ObjectlimitsPear imagePear image borders4U5. Border DetectionIntroduction: Whatisa edge?Typesof edges•Imagediscontinuities•SmoothedversionssteplinesloperoofPresence of noise5U5. Border DetectionIntroduction: stepsin edgedetectionEdgedetector = Algorithmthatproduces a set of edgesfromanimage:1.Imagefilterto enhanceintensitychanges+2.Decide whichonesare eitheredgesornot.pearbordersAlgorithm6U5. Border DetectionIntroduction: stepsin edgedetectionpearImage intensity changesFiltering(step a+ step b)1.Image filter to enhance intensity changesa.Smoothing b.Enhancement7U5. Border DetectionIntroduction: stepsin edgedetectionImage intensity changesEdgesDetection(step 2)Locateedges: 2.Detect/locate(decide whetherisanedgeornot)\u0000Errors: falseedges, lostedges.3.Subpixelprecisionestimation(optional)8U5. Border DetectionIntroduction•Whatisanedge?•Stepsin borderdetectionEdgedetectorsbasedonimagegradient•Whatisimagegradient?•DetectorsEdgedetectorsbasedonLaplacianoperator•WhatistheLaplacian?•DetectorsIndex9U5. Border DetectionWhatisimagegradient?Gradient: measure local changes•≅Intensity differencesf∇fxfxf∂∂=∇)(Positive peakNegative peakPositive peak10U5. Border DetectionWhatisimagegradient?Gradient = 1st derivative of fjyfixfyxf∂∂+∂∂=∇),(yffy∂∂=xffx∂∂=),(yxf∇It is a 2 component vector:•X gradient, fx•Y gradient, fy11U5. Border DetectionHowtodisplayimagegradientsxfxfxf12U5. Border Detection¿Qué pasa con los bordes oblícuos?Gradientin X and Y directionsxfyfyxff+13U5. Border DetectionGradientmagnitudeand orientation22),(yxffyxm+=xyffyxarctan),(=φMagnitude= EdgestrengthOrientation= Edgedirection=∇),(yxf14U5. Border DetectionGradientmagnitudeand orientationmyxff+φApprox.15U5. Border DetectionGradientfilters[]101111−⋅=−−−101101101−−−111000111Prewitt operator−11[]11−The simplest gradient operator[]111101⋅−=[]101−−101Smoothing+ EnhancementNoise sensitiveEnhancement operators →Sum of coefficients equal to 016U5. Border DetectionGradientfilters[]101121−⋅=−−−101202101−−−121000121Sobel operator[]121101⋅−=−−−101202101−−−121000121Isotropic or Frei-Chen operatorExercise: what is the decomposition?Emphasize pixels nearer to the center17U5. Border DetectionGradientfiltersDerivative of aGaussianexxG222)(σ−=exxdxdG2222σσ−−=2=σ18U5. Border DetectionGradientfiltersDerivative of aGaussian2=σ[]02.11.37.78.178.37.11.02.=G[]03.16.18.39.039.18.16.03.−−−−=dxdG19U5. Border DetectionGradientfilters22222),(σσyxxexyxG+−−=∇Derivative of aGaussian2=σ2222),(σyxeyxG+−=2=σ20U5. Border DetectionGradientfilters−1001−−−−−333503553−0110Roberts’ operator−−−−−533503533Kirsch’s masks (or compass masks)0º45º90º135º180º225º270º315ºChoose the máximum and associated direction−−−−−333303555−−−−−333305355−−−−−335305335−−−−−355305333−−−−−555303333−−−−−55350333321U5. Border DetectionEdgedetectorsbasedongradientGradient magnitude ≅Amount of change•Significant changes ≅Magnitude significant peaksf∇f|∇f|Peaks, how significant?Threshold22U5. Border DetectionEdgedetectorsbasedongradientBinarizegradient magnitude•Pixels with value > T borders|∇f|T = 50T = 20Problem 1: Border width > 1 pixelSolution: Identify as border only 1 pixel per peak.Detection =Significant localmaxima of gradient magnitudeLocal maxima23U5. Border DetectionEdgedetectorsbasedongradientProblem2: Smoothededgeslost/ impreciseProblem3: Noisefalse edgesf∇f|∇f|ThresholdNoiseLess precisionHigh gradientsLess significant peaks24U5. Border Detection•InterpolationEdgedetectorsbasedongradient1.Smoothing2.Enhancement: Gradient3.Detection: •Significant local maximaof gradient magnitude4.Subpixel precision estimation (optional)|∇f|d0d1d10===niiniiimdmd11δPositionGradient magnitude•Weighted sum•Approximate to a Gaussian25U5. Border Detection“Canny” edgedetectorConflict between:•noise reduction and•border location.Distrubution that optimize both problems Gaussian(Canny, 1986)2D Gaussian, σ=21st derivatives of a2D Gaussian, σ=226U5. Border Detection“Canny” edgedetector1.Smoothing2.Enhancement3.Detection: significant local maxima ...•Non-maximal suppression•Hysteresis threshold (double threshold)4.Subpixel precision estimation (optional)1st derivative of a GaussianOnly local maximaHysteresis threshold27U5. Border Detection“Canny” edgedetectorNon-maximal suppression:•Set to 0 gradient magnitude values which are not local maximain gradient directionOnly local maximaNon local maxima+28U5. Border Detection“Canny” edgedetectorHysteresisthreshold(doublethreshold):•Twothresholds: T1 < T2.•Gradientmagnitude> T2 edges•Gradientmagnitude< T1 no edges•Valuesin between, onlyiftheare connectedto someborderedgesLocal maximaSignificant local maxima(iterative algorithm)29U5. Border Detection“Canny” edgedetectorT1 = 30, T2 = 60T1 = 30Magnitude (local maxima)T2 = 6030U5. Border Detection“Canny” edgedetectorT1 = 80, T2 = 160Gradient magnitudeOriginal imageLocal maxima31U5. Border Detection“Canny” edgedetectorT1 = 40, T2 = 80T1 = 20, T2 = 40T1 = 80, T2 = 160T1 = 60, T2 = 120T1 = 100, T2 = 200T1 = 120, T2 = 24032U5. Border DetectionIntroduction•Whatisanedge?•Stepsin edgedetectionEdgedetectorsbasedonimagegradient•Whatisimagegradient?•DetectorsEdgedetectorsbasedonLaplacianoperator•WhatistheLaplacian?•DetectorsIndex33U5. Border DetectionWhatistheLaplace operator?Laplacian: measures changes in gradient•≅Gradient differencesf∇f222)(xfxf∂∂=∇∇2fZero crossingZero crossingZero crossing34U5. Border DetectionTheLaplace operatorLaplacian= 2nd derivative of f22222),(yfxfyxf∂∂+∂∂=∇Simple example:•Gradient offfx(x) = f(x) –f(x-1)•Laplacian offfxx(x) = fx(x) –fx(x-1) fxx(x) = f(x) –f(x-1) –f(x-1) + f(x-2) fxx(x) = f(x) –2 f(x-1) + f(x-2) []121−[]121−−Convolution:LaplaceInverseLaplace35U5. Border DetectionLaplacianfilters−−−−010141010−−−−−−−−111181111Laplace operators(invers)[]121−[]121−−Convolutiion:LaplaceInverse LaplaceMore weight to central pixels:−−−−−−−−1414204141Noise sensitve36U5. Border DetectionLaplacian+ original imagef-∇2ff + α(-∇2f )Image enhancement (sharpening)α(-∇2f )37U5. Border DetectionLaplacian+ original image+α·=+α·38U5. Border DetectionLoGfilter: Laplacianofa GaussianeyxyxG2222),(σ+−=eyxyxG2222422222σσσ+−−+=∇2nd derivative of a Gaussian (Marr-Hildreth, 1980)=Laplacian of a Gaussian (LoG)=Marr-Hildreth operator=“Mexican hat” operator39U5. Border DetectionLoGfilter: Laplacianofa Gaussian2nd derivative of a Gaussian (Marr-Hildreth, 1980)=Laplacian of a Gaussian (LoG)=Marr-Hildreth operator=“Mexican hat” operator1D Gaussian1D LoG40U5. Border DetectionLoGfilter: Laplacianofa Gaussian2nd derivative of a Gaussian (Marr-Hildreth, 1980)=Laplacian of a Gaussian (LoG)=Marr-Hildreth operator=“Mexican hat” operator2D Gaussian2D LoG41U5. Border DetectionLaplacian-basededgedetectorsLaplacian ≅Gradient differences•Detect ”zero crossings”f∇f∇2fZero crossingZero crossingZero crossingSignificant slopes42U5. Border DetectionLaplacian-basededgedetectorsZero crossing slopeChange strengthDifferent thresholds43U5. Border DetectionLaplacian-basededgedetectors∇2f1.Smooting2.Enhancement: Laplacian3.Detection: •Significant zero crossings(significant peaks in the 1st derivtaive)4.Subpixel precision estimation (optional)•InterpolationToo noisy not used in practiceLoG44U5. Border DetectionScalespaceSlopeof thezerocrossingrelatedto thechangestrength•More smoothinglessslopeσσσσcontrolstheamountof smoothing•σsmall\u0000More sensitiveto noise/ More false edges\u0000More precisionto locateedges•σlarge\u0000More lostedges/ Foundedgesare robust\u0000Lessprecision(edgeshift) / Nearbyedgescan be merged45U5. Border DetectionScalespace∇f∇2fNoiseSignificant zero crossingsLess precisionf46U5. Border DetectionScalespaceSolution:•Filterwithmasksof differentσ•Analyzeedgesbehabiourto differentfilteringscales(σisrelatedto theimagescale)\u0000σlargerobustedges,butshifted\u0000σsmallbetterlocalization47U5. Border DetectionScale spaceσ= 0.6σ= 1σ= 2σ= 4σ= 6","libVersion":"0.3.2","langs":""}